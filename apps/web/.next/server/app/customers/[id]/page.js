(()=>{var e={};e.id=238,e.ids=[238],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},73925:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>l}),t(60754),t(17202),t(74773),t(87824);var r=t(93282),a=t(5736),n=t(93906),i=t.n(n),d=t(36880),o={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>d[e]);t.d(s,o);let l=["",{children:["customers",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,60754)),"/home/user/app-WhatsAppboot/apps/web/src/app/customers/[id]/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,17202)),"/home/user/app-WhatsAppboot/apps/web/src/app/customers/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,74773)),"/home/user/app-WhatsAppboot/apps/web/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,87824,23)),"next/dist/client/components/not-found-error"]}],c=["/home/user/app-WhatsAppboot/apps/web/src/app/customers/[id]/page.tsx"],u="/customers/[id]/page",m={require:t,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/customers/[id]/page",pathname:"/customers/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},55954:(e,s,t)=>{Promise.resolve().then(t.bind(t,69284))},51025:(e,s,t)=>{Promise.resolve().then(t.bind(t,57786))},69284:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>g});var r=t(73227),a=t(20649),n=t(41043),i=t(23677),d=t(14455),o=t(29536),l=t(241),c=t(73398),u=t(87674),m=t(11250),p=t(3254),x=t(72372),h=t(38609),b=t(5328);function g(){let{id:e}=(0,n.useParams)(),s=(0,n.useRouter)(),t=(0,d.NL)(),g=(0,o.a)({queryKey:["customer",e],queryFn:async()=>(0,u.R1)(`/api/customers/${e}`)}),{user:v}=(0,h.a)(),f=g.data,[j,N]=(0,i.useState)(""),[y,A]=(0,i.useState)(""),[w,P]=(0,i.useState)(""),[M,E]=(0,i.useState)(""),[_,D]=(0,i.useState)(null),q=(0,p.p)(),S=(0,x.N)(),C=(0,l.D)({mutationFn:async()=>(0,u.pE)(`/api/customers/${e}`,{name:j,phone:y,email:w,notes:M}),onSuccess:async()=>{await t.invalidateQueries({queryKey:["customer",e]}),await t.invalidateQueries({queryKey:["customers"]}),q.success("Customer updated")},onError:e=>{let s=e?.message||"Failed to save";D(s),q.error(s)}}),G=(0,l.D)({mutationFn:async()=>(0,u.QW)(`/api/customers/${e}`),onSuccess:async()=>{await t.invalidateQueries({queryKey:["customers"]}),q.success("Customer deleted"),s.replace("/customers")},onError:e=>{let s=e?.message||"Failed to delete";D(s),q.error(s)}}),R=!!f&&(f._count?.devices||0)+(f._count?.jobs||0)>0;return r.jsx(c.Z,{children:(0,r.jsxs)("section",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-muted-foreground",children:"Customer Detail"}),r.jsx("h1",{className:"text-2xl font-semibold",children:f?f.name:"Loading…"}),f?r.jsx("p",{className:"text-sm text-muted-foreground",children:f.phone}):null]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[r.jsx(m.z,{variant:"outline",asChild:!0,children:r.jsx(a.default,{href:"/customers",children:"Back"})}),(0,b.A)(v?.role,["ADMIN","MANAGER"])?r.jsx(m.z,{variant:"destructive",disabled:R||G.isPending,onClick:async()=>{await S({title:"Delete customer",description:"Are you sure you want to delete this customer? This action cannot be undone.",variant:"destructive",confirmText:"Delete"})&&G.mutate()},children:R?"Has records":"Delete"}):null]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-3",children:[(0,r.jsxs)("div",{className:"md:col-span-2 rounded-xl border bg-card p-4",children:[r.jsx("h2",{className:"mb-3 text-lg font-semibold",children:"Edit Customer"}),(0,b.A)(v?.role,["ADMIN","MANAGER"])?null:r.jsx("p",{className:"mb-3 text-sm text-amber-700",children:"You have read-only access. Editing is restricted to Admin/Manager."}),R?r.jsx("p",{className:"mb-3 text-sm text-muted-foreground",children:"This customer has related records. You can update details but deletion is disabled."}):null,(0,r.jsxs)("form",{className:"space-y-3",onSubmit:e=>{e.preventDefault(),D(null),C.mutate()},children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,r.jsxs)("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-sm font-medium",htmlFor:"name",children:"Name"}),r.jsx("input",{id:"name",value:j,onChange:e=>N(e.target.value),className:"w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm",required:!0,disabled:!(0,b.A)(v?.role,["ADMIN","MANAGER"])})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-sm font-medium",htmlFor:"phone",children:"Phone"}),r.jsx("input",{id:"phone",value:y,onChange:e=>A(e.target.value),className:"w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm",required:!0,disabled:!(0,b.A)(v?.role,["ADMIN","MANAGER"])})]})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-sm font-medium",htmlFor:"email",children:"Email"}),r.jsx("input",{id:"email",type:"email",value:w,onChange:e=>P(e.target.value),className:"w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm",disabled:!(0,b.A)(v?.role,["ADMIN","MANAGER"])})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-sm font-medium",htmlFor:"notes",children:"Notes"}),r.jsx("input",{id:"notes",value:M,onChange:e=>E(e.target.value),className:"w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm",disabled:!(0,b.A)(v?.role,["ADMIN","MANAGER"])})]}),_?r.jsx("p",{className:"text-sm text-red-500",children:_}):null,(0,b.A)(v?.role,["ADMIN","MANAGER"])?r.jsx(m.z,{type:"submit",disabled:C.isPending,children:C.isPending?"Saving…":"Save changes"}):null]})]}),(0,r.jsxs)("aside",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"rounded-xl border bg-card p-4",children:[r.jsx("h3",{className:"mb-2 text-sm font-semibold text-muted-foreground",children:"Devices"}),f?0===f.devices.length?r.jsx("p",{className:"text-sm text-muted-foreground",children:"No devices."}):r.jsx("ul",{className:"space-y-2 text-sm",children:f.devices.map(e=>r.jsx("li",{children:r.jsx(a.default,{href:`/devices/${e.id}`,className:"underline hover:no-underline",children:[e.deviceType,e.brand,e.model].filter(Boolean).join(" ")})},e.id))}):r.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading…"})]}),(0,r.jsxs)("div",{className:"rounded-xl border bg-card p-4",children:[r.jsx("h3",{className:"mb-2 text-sm font-semibold text-muted-foreground",children:"Jobs"}),f?0===f.jobs.length?r.jsx("p",{className:"text-sm text-muted-foreground",children:"No jobs."}):r.jsx("ul",{className:"space-y-2 text-sm",children:f.jobs.map(e=>(0,r.jsxs)("li",{className:"flex items-center justify-between gap-2",children:[r.jsx(a.default,{href:`/jobs/${e.id}`,className:"underline hover:no-underline",children:e.title}),r.jsx("span",{className:"text-xs text-muted-foreground",children:new Date(e.createdAt).toLocaleString()})]},e.id))}):r.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading…"})]})]})]})]})})}},57786:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>n});var r=t(73227),a=t(90708);function n({children:e}){return r.jsx(a.L,{children:e})}},11250:(e,s,t)=>{"use strict";t.d(s,{z:()=>l});var r=t(73227),a=t(23677),n=t(62007),i=t(31086),d=t(18755);let o=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",outline:"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),l=a.forwardRef(({className:e,variant:s,size:t,asChild:a=!1,...i},l)=>{let c=a?n.g7:"button";return r.jsx(c,{className:(0,d.cn)(o({variant:s,size:t,className:e})),ref:l,...i})});l.displayName="Button"},5328:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(e,s)=>!!e&&s.includes(e)},60754:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(53189).createProxy)(String.raw`/home/user/app-WhatsAppboot/apps/web/src/app/customers/[id]/page.tsx#default`)},17202:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(53189).createProxy)(String.raw`/home/user/app-WhatsAppboot/apps/web/src/app/customers/layout.tsx#default`)}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[193,2,456,415,916,933,777,708],()=>t(73925));module.exports=r})();