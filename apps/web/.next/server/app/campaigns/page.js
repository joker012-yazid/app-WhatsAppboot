(()=>{var e={};e.id=905,e.ids=[905],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},15265:(e,s,a)=>{"use strict";a.r(s),a.d(s,{GlobalError:()=>l.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>o,routeModule:()=>p,tree:()=>c}),a(72606),a(10636),a(74773),a(87824);var t=a(93282),r=a(5736),n=a(93906),l=a.n(n),i=a(36880),d={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);a.d(s,d);let c=["",{children:["campaigns",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,72606)),"/home/user/app-WhatsAppboot/apps/web/src/app/campaigns/page.tsx"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,10636)),"/home/user/app-WhatsAppboot/apps/web/src/app/campaigns/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,74773)),"/home/user/app-WhatsAppboot/apps/web/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,87824,23)),"next/dist/client/components/not-found-error"]}],o=["/home/user/app-WhatsAppboot/apps/web/src/app/campaigns/page.tsx"],m="/campaigns/page",u={require:a,loadChunk:()=>Promise.resolve()},p=new t.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/campaigns/page",pathname:"/campaigns",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},65269:(e,s,a)=>{Promise.resolve().then(a.bind(a,94248))},76352:(e,s,a)=>{Promise.resolve().then(a.bind(a,7730))},94248:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>n});var t=a(73227),r=a(90708);function n({children:e}){return t.jsx(r.L,{children:e})}},7730:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>f});var t=a(73227),r=a(23677),n=a(14455),l=a(29536),i=a(241),d=a(73398),c=a(87674),o=a(11250),m=a(3254),u=a(408),p=a(73195),x=a(55242);let g=["PROMOTIONAL","ANNOUNCEMENT","FOLLOW_UP","CUSTOM"],h=["VIP","REGULAR","NEW","PROSPECT"],b=e=>{if(!e)return 0;let[s,a]=e.split(":").map(e=>Number(e));return 60*s+a};function f(){let e=(0,n.NL)(),s=(0,m.p)(),[a,f]=(0,r.useState)("New Campaign"),[j,N]=(0,r.useState)("PROMOTIONAL"),[v,y]=(0,r.useState)("Hi {name}, kami ada promo terbaru minggu ini. Balas jika berminat!"),[w,C]=(0,r.useState)(["REGULAR"]),[P,S]=(0,r.useState)(""),[E,k]=(0,r.useState)("OPT_OUT"),[A,D]=(0,r.useState)("90"),[L,z]=(0,r.useState)(""),[_,O]=(0,r.useState)(""),[T,R]=(0,r.useState)("09:00"),[M,U]=(0,r.useState)("18:00"),[q,F]=(0,r.useState)("150"),[I,W]=(0,r.useState)("30"),[G,B]=(0,r.useState)("60"),[$,H]=(0,r.useState)(""),[K,Z]=(0,r.useState)(null),Q=(0,l.a)({queryKey:["campaigns"],queryFn:async()=>(0,c.R1)("/api/campaigns")}),V=()=>{let e=_.split(/\n|,/).map(e=>e.trim()).filter(Boolean);return{customerTypes:w.length?w:void 0,tags:P?P.split(",").map(e=>e.trim()).filter(Boolean):void 0,excludeTags:E?E.split(",").map(e=>e.trim()).filter(Boolean):void 0,lastVisitDays:A?Number(A):void 0,inactiveDays:L?Number(L):void 0,manualPhones:e.length?e:void 0}},X=(0,i.D)({mutationFn:async()=>(0,c.sg)("/api/campaigns",{name:a,kind:j,message:v,filters:V(),businessHours:{start:b(T),end:b(M)},dailyLimit:Number(q)||150,randomDelay:{min:Number(I)||30,max:Number(G)||60},scheduledFor:$?new Date($).toISOString():void 0}),onSuccess:()=>{s.success("Campaign saved"),e.invalidateQueries({queryKey:["campaigns"]})},onError:e=>s.error(e?.message||"Unable to save campaign")}),J=(0,i.D)({mutationFn:async()=>(0,c.sg)("/api/campaigns/preview",{filters:V()}),onSuccess:e=>Z(e),onError:e=>s.error(e?.message||"Preview failed")}),Y=(0,i.D)({mutationFn:async({id:e,action:s})=>(0,c.sg)(`/api/campaigns/${e}/${s}`,{}),onSuccess:(a,t)=>{s.success(`Campaign ${t.action}`),e.invalidateQueries({queryKey:["campaigns"]})},onError:e=>s.error(e?.message||"Action failed")}),ee=e=>{switch(e){case"RUNNING":return"bg-emerald-100 text-emerald-700";case"PAUSED":return"bg-yellow-100 text-yellow-700";case"COMPLETED":return"bg-blue-100 text-blue-700";case"CANCELLED":return"bg-gray-200 text-gray-700";default:return"bg-slate-100 text-slate-700"}};return t.jsx(d.Z,{children:(0,t.jsxs)("section",{className:"space-y-8",children:[t.jsx("div",{className:"rounded-xl border bg-card/80 px-6 py-5 shadow-sm backdrop-blur",children:t.jsx(x.SectionHeader,{icon:t.jsx(u.Z,{className:"h-4 w-4"}),overline:"Campaigns",title:"Campaigns",description:"Configure outbound WhatsApp campaigns with anti-ban rules.",actions:(0,t.jsxs)("div",{className:"flex gap-2",children:[t.jsx(o.z,{variant:"outline",onClick:()=>J.mutate(),disabled:J.isPending,children:J.isPending?"Previewing...":"Preview filters"}),t.jsx(o.z,{onClick:()=>X.mutate(),disabled:X.isPending,children:X.isPending?"Saving...":"Save Draft"})]})})}),(0,t.jsxs)("div",{className:"grid gap-6 lg:grid-cols-3",children:[(0,t.jsxs)("div",{className:"space-y-4 rounded-xl border bg-card p-4 lg:col-span-2",children:[t.jsx("h2",{className:"font-semibold",children:"Campaign brief"}),(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,t.jsxs)("label",{className:"space-y-1 text-sm",children:[t.jsx("span",{className:"font-medium",children:"Name"}),t.jsx("input",{className:"w-full rounded-md border bg-transparent px-3 py-2",value:a,onChange:e=>f(e.target.value)})]}),(0,t.jsxs)("label",{className:"space-y-1 text-sm",children:[t.jsx("span",{className:"font-medium",children:"Kind"}),t.jsx("select",{className:"w-full rounded-md border bg-background px-3 py-2 text-foreground",value:j,onChange:e=>N(e.target.value),children:g.map(e=>t.jsx("option",{value:e,className:"bg-background text-foreground",children:e.replace("_"," ")},e))})]}),(0,t.jsxs)("label",{className:"space-y-1 text-sm",children:[t.jsx("span",{className:"font-medium",children:"Business hours (start)"}),t.jsx("input",{type:"time",className:"w-full rounded-md border bg-transparent px-3 py-2",value:T,onChange:e=>R(e.target.value)})]}),(0,t.jsxs)("label",{className:"space-y-1 text-sm",children:[t.jsx("span",{className:"font-medium",children:"Business hours (end)"}),t.jsx("input",{type:"time",className:"w-full rounded-md border bg-transparent px-3 py-2",value:M,onChange:e=>U(e.target.value)})]}),(0,t.jsxs)("label",{className:"space-y-1 text-sm",children:[t.jsx("span",{className:"font-medium",children:"Daily limit"}),t.jsx("input",{type:"number",className:"w-full rounded-md border bg-transparent px-3 py-2",value:q,onChange:e=>F(e.target.value)})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,t.jsxs)("label",{className:"space-y-1 text-sm",children:[t.jsx("span",{className:"font-medium",children:"Delay min (s)"}),t.jsx("input",{type:"number",className:"w-full rounded-md border bg-transparent px-3 py-2",value:I,onChange:e=>W(e.target.value)})]}),(0,t.jsxs)("label",{className:"space-y-1 text-sm",children:[t.jsx("span",{className:"font-medium",children:"Delay max (s)"}),t.jsx("input",{type:"number",className:"w-full rounded-md border bg-transparent px-3 py-2",value:G,onChange:e=>B(e.target.value)})]})]}),(0,t.jsxs)("label",{className:"space-y-1 text-sm md:col-span-2",children:[t.jsx("span",{className:"font-medium",children:"Schedule (optional)"}),t.jsx("input",{type:"datetime-local",className:"w-full rounded-md border bg-transparent px-3 py-2",value:$,onChange:e=>H(e.target.value)})]})]}),(0,t.jsxs)("label",{className:"space-y-1 text-sm",children:[t.jsx("span",{className:"font-medium",children:"Message Template"}),t.jsx("textarea",{className:"min-h-[140px] w-full rounded-md border bg-transparent px-3 py-2",value:v,onChange:e=>y(e.target.value)}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Use variables like ","{name}"," or ","{phone}",". Delays & business hours are enforced automatically."]})]})]}),(0,t.jsxs)("div",{className:"space-y-4 rounded-xl border bg-card p-4",children:[t.jsx("h2",{className:"font-semibold",children:"Filters"}),(0,t.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,t.jsxs)("div",{children:[t.jsx("p",{className:"font-medium",children:"Customer Types"}),t.jsx("div",{className:"flex flex-wrap gap-2 pt-1 text-xs",children:h.map(e=>t.jsx("button",{type:"button",onClick:()=>C(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e]),className:`rounded-full border px-3 py-1 ${w.includes(e)?"border-primary bg-primary/10 text-primary":"text-muted-foreground"}`,children:e},e))})]}),(0,t.jsxs)("label",{className:"space-y-1",children:[t.jsx("span",{className:"font-medium",children:"Include tags (comma separated)"}),t.jsx("input",{className:"w-full rounded-md border bg-transparent px-3 py-2",value:P,onChange:e=>S(e.target.value)})]}),(0,t.jsxs)("label",{className:"space-y-1",children:[t.jsx("span",{className:"font-medium",children:"Exclude tags"}),t.jsx("input",{className:"w-full rounded-md border bg-transparent px-3 py-2",value:E,onChange:e=>k(e.target.value)})]}),(0,t.jsxs)("label",{className:"space-y-1",children:[t.jsx("span",{className:"font-medium",children:"Last visit within (days)"}),t.jsx("input",{type:"number",className:"w-full rounded-md border bg-transparent px-3 py-2",value:A,onChange:e=>D(e.target.value)})]}),(0,t.jsxs)("label",{className:"space-y-1",children:[t.jsx("span",{className:"font-medium",children:"Inactive for at least (days)"}),t.jsx("input",{type:"number",className:"w-full rounded-md border bg-transparent px-3 py-2",value:L,onChange:e=>z(e.target.value)})]}),(0,t.jsxs)("label",{className:"space-y-1",children:[t.jsx("span",{className:"font-medium",children:"Manual phone numbers"}),t.jsx("textarea",{className:"h-24 w-full rounded-md border bg-transparent px-3 py-2",value:_,onChange:e=>O(e.target.value),placeholder:"Separate numbers with commas or new lines"})]})]}),K?(0,t.jsxs)("div",{className:"rounded-lg border bg-background p-3 text-xs",children:[t.jsx("p",{className:"font-semibold",children:"Preview"}),(0,t.jsxs)("p",{className:"text-muted-foreground",children:["Matches: ",K.totalCustomers," | Manual: ",K.manualCount]}),t.jsx("ul",{className:"mt-2 space-y-1",children:K.sample.slice(0,5).map(e=>(0,t.jsxs)("li",{className:"flex justify-between",children:[t.jsx("span",{children:e.name}),t.jsx("span",{className:"font-mono",children:e.phone})]},`${e.phone}-${e.customerId}`))})]}):null]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[t.jsx("h2",{className:"text-xl font-semibold",children:"Existing campaigns"}),t.jsx(o.z,{variant:"ghost",size:"sm",onClick:()=>e.invalidateQueries({queryKey:["campaigns"]}),children:"Refresh"})]}),Q.isLoading?t.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading campaigns..."}):Q.isError?t.jsx("p",{className:"text-sm text-red-500",children:"Failed to load campaigns"}):Q.data?.length?t.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:Q.data.map(e=>(0,t.jsxs)("article",{className:"rounded-xl border bg-card p-4",children:[(0,t.jsxs)("header",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:e.kind}),t.jsx("h3",{className:"text-lg font-semibold",children:e.name})]}),t.jsx("span",{className:`rounded-full px-2 py-1 text-xs font-semibold ${ee(e.status)}`,children:e.status})]}),(0,t.jsxs)("dl",{className:"mt-3 grid grid-cols-3 gap-3 text-xs",children:[(0,t.jsxs)("div",{children:[t.jsx("dt",{className:"text-muted-foreground",children:"Targets"}),t.jsx("dd",{className:"text-base font-semibold",children:e.targetCount})]}),(0,t.jsxs)("div",{children:[t.jsx("dt",{className:"text-muted-foreground",children:"Sent"}),t.jsx("dd",{className:"text-base font-semibold text-emerald-600",children:e.sentCount})]}),(0,t.jsxs)("div",{children:[t.jsx("dt",{className:"text-muted-foreground",children:"Failed"}),t.jsx("dd",{className:"text-base font-semibold text-red-600",children:e.failedCount})]})]}),(0,t.jsxs)("div",{className:"mt-4 flex flex-wrap gap-2 text-xs",children:[e.scheduledFor?(0,t.jsxs)("span",{className:"rounded bg-muted px-2 py-1",children:["Scheduled: ",new Date(e.scheduledFor).toLocaleString()]}):null,e.startedAt?(0,t.jsxs)("span",{className:"rounded bg-muted px-2 py-1",children:["Started: ",new Date(e.startedAt).toLocaleString()]}):null,(0,t.jsxs)("span",{className:"rounded bg-muted px-2 py-1",children:["Daily limit: ",e.dailyLimit]})]}),(0,t.jsxs)("div",{className:"mt-4 flex flex-wrap gap-2 text-sm",children:[["DRAFT","SCHEDULED","PAUSED"].includes(e.status)?t.jsx(o.z,{size:"sm",onClick:()=>Y.mutate({id:e.id,action:"start"}),disabled:Y.isPending,children:"Start"}):null,"RUNNING"===e.status?t.jsx(o.z,{size:"sm",variant:"outline",onClick:()=>Y.mutate({id:e.id,action:"pause"}),disabled:Y.isPending,children:"Pause"}):null,"PAUSED"===e.status?t.jsx(o.z,{size:"sm",variant:"outline",onClick:()=>Y.mutate({id:e.id,action:"resume"}),disabled:Y.isPending,children:"Resume"}):null,["COMPLETED","CANCELLED"].includes(e.status)?null:t.jsx(o.z,{size:"sm",variant:"destructive",onClick:()=>Y.mutate({id:e.id,action:"cancel"}),disabled:Y.isPending,children:"Cancel"})]})]},e.id))}):(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center gap-2 py-10 text-center text-muted-foreground",children:[t.jsx("div",{className:"mb-2 flex h-16 w-16 items-center justify-center rounded-full border border-dashed border-slate-800 bg-slate-950/60",children:t.jsx(p.Z,{className:"h-7 w-7 text-slate-500"})}),t.jsx("p",{className:"text-sm font-medium text-slate-100",children:"No campaigns yet"}),t.jsx("p",{className:"text-xs text-slate-400",children:"Draft a campaign and preview your filters to begin outreach."}),t.jsx(o.z,{size:"sm",className:"mt-2",onClick:()=>X.mutate(),disabled:X.isPending,children:X.isPending?"Saving...":"Create your first campaign"})]})]})]})})}},55242:(e,s,a)=>{"use strict";a.d(s,{SectionHeader:()=>n});var t=a(73227),r=a(18755);function n({icon:e,overline:s,title:a,description:n,actions:l,className:i}){return(0,t.jsxs)("div",{className:(0,r.cn)("flex flex-wrap items-center justify-between gap-4",i),children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[e?t.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-full border border-sky-500/30 bg-sky-500/10 text-sky-400 shadow-sm",children:e}):null,(0,t.jsxs)("div",{children:[s?t.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-slate-400",children:s}):null,t.jsx("h1",{className:"text-xl font-semibold text-slate-50 md:text-2xl",children:a}),n?t.jsx("p",{className:"text-sm text-muted-foreground",children:n}):null]})]}),l?t.jsx("div",{className:"flex flex-wrap items-center gap-3",children:l}):null]})}},11250:(e,s,a)=>{"use strict";a.d(s,{z:()=>c});var t=a(73227),r=a(23677),n=a(62007),l=a(31086),i=a(18755);let d=(0,l.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",outline:"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=r.forwardRef(({className:e,variant:s,size:a,asChild:r=!1,...l},c)=>{let o=r?n.g7:"button";return t.jsx(o,{className:(0,i.cn)(d({variant:s,size:a,className:e})),ref:c,...l})});c.displayName="Button"},73195:(e,s,a)=>{"use strict";a.d(s,{Z:()=>t});let t=(0,a(24583).Z)("Inbox",[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]])},10636:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>t});let t=(0,a(53189).createProxy)(String.raw`/home/user/app-WhatsAppboot/apps/web/src/app/campaigns/layout.tsx#default`)},72606:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>t});let t=(0,a(53189).createProxy)(String.raw`/home/user/app-WhatsAppboot/apps/web/src/app/campaigns/page.tsx#default`)}};var s=require("../../webpack-runtime.js");s.C(e);var a=e=>s(s.s=e),t=s.X(0,[193,2,456,415,916,933,777,708],()=>a(15265));module.exports=t})();