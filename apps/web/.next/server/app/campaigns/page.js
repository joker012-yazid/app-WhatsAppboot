(()=>{var e={};e.id=905,e.ids=[905],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5374:(e,s,a)=>{"use strict";a.r(s),a.d(s,{GlobalError:()=>l.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>o,routeModule:()=>p,tree:()=>c}),a(2606),a(8322),a(7824);var t=a(3282),n=a(5736),r=a(3906),l=a.n(r),i=a(6880),d={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);a.d(s,d);let c=["",{children:["campaigns",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,2606)),"C:\\Users\\Jokeryazid\\Documents\\My projek\\new whatsappbot\\app-WhatsAppboot\\apps\\web\\src\\app\\campaigns\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,8322)),"C:\\Users\\Jokeryazid\\Documents\\My projek\\new whatsappbot\\app-WhatsAppboot\\apps\\web\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,7824,23)),"next/dist/client/components/not-found-error"]}],o=["C:\\Users\\Jokeryazid\\Documents\\My projek\\new whatsappbot\\app-WhatsAppboot\\apps\\web\\src\\app\\campaigns\\page.tsx"],m="/campaigns/page",u={require:a,loadChunk:()=>Promise.resolve()},p=new t.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/campaigns/page",pathname:"/campaigns",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},3633:(e,s,a)=>{Promise.resolve().then(a.bind(a,6204))},6204:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>j});var t=a(3227),n=a(3677),r=a(4455),l=a(9536),i=a(241),d=a(3398),c=a(7674),o=a(1250),m=a(3254);let u=(0,a(4583).Z)("Megaphone",[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]]);var p=a(3195),x=a(5242);let g=["PROMOTIONAL","ANNOUNCEMENT","FOLLOW_UP","CUSTOM"],h=["VIP","REGULAR","NEW","PROSPECT"],b=e=>{if(!e)return 0;let[s,a]=e.split(":").map(e=>Number(e));return 60*s+a};function j(){let e=(0,r.NL)(),s=(0,m.p)(),[a,j]=(0,n.useState)("New Campaign"),[N,f]=(0,n.useState)("PROMOTIONAL"),[y,v]=(0,n.useState)("Hi {name}, kami ada promo terbaru minggu ini. Balas jika berminat!"),[w,C]=(0,n.useState)(["REGULAR"]),[P,S]=(0,n.useState)(""),[k,D]=(0,n.useState)("OPT_OUT"),[E,A]=(0,n.useState)("90"),[L,z]=(0,n.useState)(""),[M,U]=(0,n.useState)(""),[_,O]=(0,n.useState)("09:00"),[T,R]=(0,n.useState)("18:00"),[F,q]=(0,n.useState)("150"),[I,G]=(0,n.useState)("30"),[W,$]=(0,n.useState)("60"),[B,H]=(0,n.useState)(""),[Z,K]=(0,n.useState)(null),J=(0,l.a)({queryKey:["campaigns"],queryFn:async()=>(0,c.R1)("/api/campaigns")}),Q=()=>{let e=M.split(/\n|,/).map(e=>e.trim()).filter(Boolean);return{customerTypes:w.length?w:void 0,tags:P?P.split(",").map(e=>e.trim()).filter(Boolean):void 0,excludeTags:k?k.split(",").map(e=>e.trim()).filter(Boolean):void 0,lastVisitDays:E?Number(E):void 0,inactiveDays:L?Number(L):void 0,manualPhones:e.length?e:void 0}},V=(0,i.D)({mutationFn:async()=>(0,c.sg)("/api/campaigns",{name:a,kind:N,message:y,filters:Q(),businessHours:{start:b(_),end:b(T)},dailyLimit:Number(F)||150,randomDelay:{min:Number(I)||30,max:Number(W)||60},scheduledFor:B?new Date(B).toISOString():void 0}),onSuccess:()=>{s.success("Campaign saved"),e.invalidateQueries({queryKey:["campaigns"]})},onError:e=>s.error(e?.message||"Unable to save campaign")}),X=(0,i.D)({mutationFn:async()=>(0,c.sg)("/api/campaigns/preview",{filters:Q()}),onSuccess:e=>K(e),onError:e=>s.error(e?.message||"Preview failed")}),Y=(0,i.D)({mutationFn:async({id:e,action:s})=>(0,c.sg)(`/api/campaigns/${e}/${s}`,{}),onSuccess:(a,t)=>{s.success(`Campaign ${t.action}`),e.invalidateQueries({queryKey:["campaigns"]})},onError:e=>s.error(e?.message||"Action failed")}),ee=e=>{switch(e){case"RUNNING":return"bg-emerald-100 text-emerald-700";case"PAUSED":return"bg-yellow-100 text-yellow-700";case"COMPLETED":return"bg-blue-100 text-blue-700";case"CANCELLED":return"bg-gray-200 text-gray-700";default:return"bg-slate-100 text-slate-700"}};return t.jsx(d.Z,{children:(0,t.jsxs)("section",{className:"space-y-8",children:[t.jsx("div",{className:"rounded-xl border bg-card/80 px-6 py-5 shadow-sm backdrop-blur",children:t.jsx(x.SectionHeader,{icon:t.jsx(u,{className:"h-4 w-4"}),overline:"Campaigns",title:"Campaigns",description:"Configure outbound WhatsApp campaigns with anti-ban rules.",actions:(0,t.jsxs)("div",{className:"flex gap-2",children:[t.jsx(o.z,{variant:"outline",onClick:()=>X.mutate(),disabled:X.isPending,children:X.isPending?"Previewing...":"Preview filters"}),t.jsx(o.z,{onClick:()=>V.mutate(),disabled:V.isPending,children:V.isPending?"Saving...":"Save Draft"})]})})}),(0,t.jsxs)("div",{className:"grid gap-6 lg:grid-cols-3",children:[(0,t.jsxs)("div",{className:"space-y-4 rounded-xl border bg-card p-4 lg:col-span-2",children:[t.jsx("h2",{className:"font-semibold",children:"Campaign brief"}),(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,t.jsxs)("label",{className:"space-y-1 text-sm",children:[t.jsx("span",{className:"font-medium",children:"Name"}),t.jsx("input",{className:"w-full rounded-md border bg-transparent px-3 py-2",value:a,onChange:e=>j(e.target.value)})]}),(0,t.jsxs)("label",{className:"space-y-1 text-sm",children:[t.jsx("span",{className:"font-medium",children:"Kind"}),t.jsx("select",{className:"w-full rounded-md border bg-background px-3 py-2 text-foreground",value:N,onChange:e=>f(e.target.value),children:g.map(e=>t.jsx("option",{value:e,className:"bg-background text-foreground",children:e.replace("_"," ")},e))})]}),(0,t.jsxs)("label",{className:"space-y-1 text-sm",children:[t.jsx("span",{className:"font-medium",children:"Business hours (start)"}),t.jsx("input",{type:"time",className:"w-full rounded-md border bg-transparent px-3 py-2",value:_,onChange:e=>O(e.target.value)})]}),(0,t.jsxs)("label",{className:"space-y-1 text-sm",children:[t.jsx("span",{className:"font-medium",children:"Business hours (end)"}),t.jsx("input",{type:"time",className:"w-full rounded-md border bg-transparent px-3 py-2",value:T,onChange:e=>R(e.target.value)})]}),(0,t.jsxs)("label",{className:"space-y-1 text-sm",children:[t.jsx("span",{className:"font-medium",children:"Daily limit"}),t.jsx("input",{type:"number",className:"w-full rounded-md border bg-transparent px-3 py-2",value:F,onChange:e=>q(e.target.value)})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,t.jsxs)("label",{className:"space-y-1 text-sm",children:[t.jsx("span",{className:"font-medium",children:"Delay min (s)"}),t.jsx("input",{type:"number",className:"w-full rounded-md border bg-transparent px-3 py-2",value:I,onChange:e=>G(e.target.value)})]}),(0,t.jsxs)("label",{className:"space-y-1 text-sm",children:[t.jsx("span",{className:"font-medium",children:"Delay max (s)"}),t.jsx("input",{type:"number",className:"w-full rounded-md border bg-transparent px-3 py-2",value:W,onChange:e=>$(e.target.value)})]})]}),(0,t.jsxs)("label",{className:"space-y-1 text-sm md:col-span-2",children:[t.jsx("span",{className:"font-medium",children:"Schedule (optional)"}),t.jsx("input",{type:"datetime-local",className:"w-full rounded-md border bg-transparent px-3 py-2",value:B,onChange:e=>H(e.target.value)})]})]}),(0,t.jsxs)("label",{className:"space-y-1 text-sm",children:[t.jsx("span",{className:"font-medium",children:"Message Template"}),t.jsx("textarea",{className:"min-h-[140px] w-full rounded-md border bg-transparent px-3 py-2",value:y,onChange:e=>v(e.target.value)}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Use variables like ","{name}"," or ","{phone}",". Delays & business hours are enforced automatically."]})]})]}),(0,t.jsxs)("div",{className:"space-y-4 rounded-xl border bg-card p-4",children:[t.jsx("h2",{className:"font-semibold",children:"Filters"}),(0,t.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,t.jsxs)("div",{children:[t.jsx("p",{className:"font-medium",children:"Customer Types"}),t.jsx("div",{className:"flex flex-wrap gap-2 pt-1 text-xs",children:h.map(e=>t.jsx("button",{type:"button",onClick:()=>C(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e]),className:`rounded-full border px-3 py-1 ${w.includes(e)?"border-primary bg-primary/10 text-primary":"text-muted-foreground"}`,children:e},e))})]}),(0,t.jsxs)("label",{className:"space-y-1",children:[t.jsx("span",{className:"font-medium",children:"Include tags (comma separated)"}),t.jsx("input",{className:"w-full rounded-md border bg-transparent px-3 py-2",value:P,onChange:e=>S(e.target.value)})]}),(0,t.jsxs)("label",{className:"space-y-1",children:[t.jsx("span",{className:"font-medium",children:"Exclude tags"}),t.jsx("input",{className:"w-full rounded-md border bg-transparent px-3 py-2",value:k,onChange:e=>D(e.target.value)})]}),(0,t.jsxs)("label",{className:"space-y-1",children:[t.jsx("span",{className:"font-medium",children:"Last visit within (days)"}),t.jsx("input",{type:"number",className:"w-full rounded-md border bg-transparent px-3 py-2",value:E,onChange:e=>A(e.target.value)})]}),(0,t.jsxs)("label",{className:"space-y-1",children:[t.jsx("span",{className:"font-medium",children:"Inactive for at least (days)"}),t.jsx("input",{type:"number",className:"w-full rounded-md border bg-transparent px-3 py-2",value:L,onChange:e=>z(e.target.value)})]}),(0,t.jsxs)("label",{className:"space-y-1",children:[t.jsx("span",{className:"font-medium",children:"Manual phone numbers"}),t.jsx("textarea",{className:"h-24 w-full rounded-md border bg-transparent px-3 py-2",value:M,onChange:e=>U(e.target.value),placeholder:"Separate numbers with commas or new lines"})]})]}),Z?(0,t.jsxs)("div",{className:"rounded-lg border bg-background p-3 text-xs",children:[t.jsx("p",{className:"font-semibold",children:"Preview"}),(0,t.jsxs)("p",{className:"text-muted-foreground",children:["Matches: ",Z.totalCustomers," | Manual: ",Z.manualCount]}),t.jsx("ul",{className:"mt-2 space-y-1",children:Z.sample.slice(0,5).map(e=>(0,t.jsxs)("li",{className:"flex justify-between",children:[t.jsx("span",{children:e.name}),t.jsx("span",{className:"font-mono",children:e.phone})]},`${e.phone}-${e.customerId}`))})]}):null]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[t.jsx("h2",{className:"text-xl font-semibold",children:"Existing campaigns"}),t.jsx(o.z,{variant:"ghost",size:"sm",onClick:()=>e.invalidateQueries({queryKey:["campaigns"]}),children:"Refresh"})]}),J.isLoading?t.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading campaigns..."}):J.isError?t.jsx("p",{className:"text-sm text-red-500",children:"Failed to load campaigns"}):J.data?.length?t.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:J.data.map(e=>(0,t.jsxs)("article",{className:"rounded-xl border bg-card p-4",children:[(0,t.jsxs)("header",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:e.kind}),t.jsx("h3",{className:"text-lg font-semibold",children:e.name})]}),t.jsx("span",{className:`rounded-full px-2 py-1 text-xs font-semibold ${ee(e.status)}`,children:e.status})]}),(0,t.jsxs)("dl",{className:"mt-3 grid grid-cols-3 gap-3 text-xs",children:[(0,t.jsxs)("div",{children:[t.jsx("dt",{className:"text-muted-foreground",children:"Targets"}),t.jsx("dd",{className:"text-base font-semibold",children:e.targetCount})]}),(0,t.jsxs)("div",{children:[t.jsx("dt",{className:"text-muted-foreground",children:"Sent"}),t.jsx("dd",{className:"text-base font-semibold text-emerald-600",children:e.sentCount})]}),(0,t.jsxs)("div",{children:[t.jsx("dt",{className:"text-muted-foreground",children:"Failed"}),t.jsx("dd",{className:"text-base font-semibold text-red-600",children:e.failedCount})]})]}),(0,t.jsxs)("div",{className:"mt-4 flex flex-wrap gap-2 text-xs",children:[e.scheduledFor?(0,t.jsxs)("span",{className:"rounded bg-muted px-2 py-1",children:["Scheduled: ",new Date(e.scheduledFor).toLocaleString()]}):null,e.startedAt?(0,t.jsxs)("span",{className:"rounded bg-muted px-2 py-1",children:["Started: ",new Date(e.startedAt).toLocaleString()]}):null,(0,t.jsxs)("span",{className:"rounded bg-muted px-2 py-1",children:["Daily limit: ",e.dailyLimit]})]}),(0,t.jsxs)("div",{className:"mt-4 flex flex-wrap gap-2 text-sm",children:[["DRAFT","SCHEDULED","PAUSED"].includes(e.status)?t.jsx(o.z,{size:"sm",onClick:()=>Y.mutate({id:e.id,action:"start"}),disabled:Y.isPending,children:"Start"}):null,"RUNNING"===e.status?t.jsx(o.z,{size:"sm",variant:"outline",onClick:()=>Y.mutate({id:e.id,action:"pause"}),disabled:Y.isPending,children:"Pause"}):null,"PAUSED"===e.status?t.jsx(o.z,{size:"sm",variant:"outline",onClick:()=>Y.mutate({id:e.id,action:"resume"}),disabled:Y.isPending,children:"Resume"}):null,["COMPLETED","CANCELLED"].includes(e.status)?null:t.jsx(o.z,{size:"sm",variant:"destructive",onClick:()=>Y.mutate({id:e.id,action:"cancel"}),disabled:Y.isPending,children:"Cancel"})]})]},e.id))}):(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center gap-2 py-10 text-center text-muted-foreground",children:[t.jsx("div",{className:"mb-2 flex h-16 w-16 items-center justify-center rounded-full border border-dashed border-slate-800 bg-slate-950/60",children:t.jsx(p.Z,{className:"h-7 w-7 text-slate-500"})}),t.jsx("p",{className:"text-sm font-medium text-slate-100",children:"No campaigns yet"}),t.jsx("p",{className:"text-xs text-slate-400",children:"Draft a campaign and preview your filters to begin outreach."}),t.jsx(o.z,{size:"sm",className:"mt-2",onClick:()=>V.mutate(),disabled:V.isPending,children:V.isPending?"Saving...":"Create your first campaign"})]})]})]})})}},3398:(e,s,a)=>{"use strict";a.d(s,{Z:()=>l});var t=a(3227),n=a(1043);a(3677);var r=a(8609);function l({children:e,redirectOnFail:s=!0}){let{user:a,loading:l,error:i,status:d}=(0,r.a)();return((0,n.useRouter)(),l)?t.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading session..."}):!a&&s?null:t.jsx(t.Fragment,{children:e})}},5242:(e,s,a)=>{"use strict";a.d(s,{SectionHeader:()=>r});var t=a(3227),n=a(8755);function r({icon:e,overline:s,title:a,description:r,actions:l,className:i}){return(0,t.jsxs)("div",{className:(0,n.cn)("flex flex-wrap items-center justify-between gap-4",i),children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[e?t.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-full border border-sky-500/30 bg-sky-500/10 text-sky-400 shadow-sm",children:e}):null,(0,t.jsxs)("div",{children:[s?t.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-slate-400",children:s}):null,t.jsx("h1",{className:"text-xl font-semibold text-slate-50 md:text-2xl",children:a}),r?t.jsx("p",{className:"text-sm text-muted-foreground",children:r}):null]})]}),l?t.jsx("div",{className:"flex flex-wrap items-center gap-3",children:l}):null]})}},3195:(e,s,a)=>{"use strict";a.d(s,{Z:()=>t});let t=(0,a(4583).Z)("Inbox",[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]])},2606:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>t});let t=(0,a(3189).createProxy)(String.raw`C:\Users\Jokeryazid\Documents\My projek\new whatsappbot\app-WhatsAppboot\apps\web\src\app\campaigns\page.tsx#default`)}};var s=require("../../webpack-runtime.js");s.C(e);var a=e=>s(s.s=e),t=s.X(0,[193,937,933,420],()=>a(5374));module.exports=t})();