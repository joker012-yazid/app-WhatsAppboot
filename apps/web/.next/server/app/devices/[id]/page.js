(()=>{var e={};e.id=684,e.ids=[684],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9511:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>d.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>o}),t(7662),t(8322),t(7824);var a=t(3282),r=t(5736),i=t(3906),d=t.n(i),n=t(6880),l={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>n[e]);t.d(s,l);let o=["",{children:["devices",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,7662)),"C:\\Users\\Jokeryazid\\Documents\\My projek\\new whatsappbot\\app-WhatsAppboot\\apps\\web\\src\\app\\devices\\[id]\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,8322)),"C:\\Users\\Jokeryazid\\Documents\\My projek\\new whatsappbot\\app-WhatsAppboot\\apps\\web\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,7824,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\Jokeryazid\\Documents\\My projek\\new whatsappbot\\app-WhatsAppboot\\apps\\web\\src\\app\\devices\\[id]\\page.tsx"],u="/devices/[id]/page",p={require:t,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/devices/[id]/page",pathname:"/devices/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},1243:(e,s,t)=>{Promise.resolve().then(t.bind(t,8872))},8872:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>v});var a=t(3227),r=t(649),i=t(1043),d=t(4455),n=t(9536),l=t(241),o=t(3677),c=t(3398),u=t(7674),p=t(1250),m=t(3254),x=t(2372),h=t(8609),b=t(5328);function v(){let{id:e}=(0,i.useParams)(),s=(0,i.useRouter)(),{user:t}=(0,h.a)(),v=(0,d.NL)(),g=(0,n.a)({queryKey:["device",e],queryFn:async()=>(0,u.R1)(`/api/devices/${e}`)}).data,[N,j]=(0,o.useState)(""),[y,A]=(0,o.useState)(""),[f,C]=(0,o.useState)(""),[w,D]=(0,o.useState)(""),[M,E]=(0,o.useState)(""),[I,P]=(0,o.useState)(null),_=(0,m.p)(),k=(0,x.N)(),q=(0,l.D)({mutationFn:async()=>(0,u.pE)(`/api/devices/${e}`,{deviceType:N,brand:y,model:f,serialNumber:w,notes:M}),onSuccess:async()=>{await v.invalidateQueries({queryKey:["device",e]}),await v.invalidateQueries({queryKey:["devices"]}),_.success("Device updated")},onError:e=>{let s=e?.message||"Failed to save";P(s),_.error(s)}}),R=(0,l.D)({mutationFn:async()=>(0,u.QW)(`/api/devices/${e}`),onSuccess:async()=>{await v.invalidateQueries({queryKey:["devices"]}),_.success("Device deleted"),s.replace("/devices")},onError:e=>{let s=e?.message||"Failed to delete";P(s),_.error(s)}});return a.jsx(c.Z,{children:(0,a.jsxs)("section",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-muted-foreground",children:"Device Detail"}),a.jsx("h1",{className:"text-2xl font-semibold",children:g?`${g.deviceType} ${g.brand||""} ${g.model||""}`:"Loading…"}),g?a.jsx("p",{className:"text-sm text-muted-foreground",children:g.customer.name}):null]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx(p.z,{variant:"outline",asChild:!0,children:a.jsx(r.default,{href:"/devices",children:"Back"})}),(0,b.A)(t?.role,["ADMIN","MANAGER"])?a.jsx(p.z,{variant:"destructive",disabled:!!g?.jobs&&g.jobs.length>0||R.isPending,onClick:async()=>{await k({title:"Delete device",description:"Are you sure you want to delete this device? This action cannot be undone.",variant:"destructive",confirmText:"Delete"})&&R.mutate()},children:g?.jobs&&g.jobs.length>0?"Has jobs":"Delete"}):null]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-3",children:[(0,a.jsxs)("div",{className:"md:col-span-2 rounded-xl border bg-card p-4",children:[a.jsx("h2",{className:"mb-3 text-lg font-semibold",children:"Edit Device"}),(0,b.A)(t?.role,["ADMIN","MANAGER","TECHNICIAN"])?null:a.jsx("p",{className:"mb-3 text-sm text-amber-700",children:"You have read-only access. Editing is restricted to Admin/Manager/Technician."}),g?.jobs&&g.jobs.length>0?(0,a.jsxs)("p",{className:"mb-3 text-sm text-amber-600",children:["This device has ",g.jobs.length," job(s). Deletion is disabled."]}):null,(0,a.jsxs)("form",{className:"space-y-3",onSubmit:e=>{e.preventDefault(),P(null),q.mutate()},children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-sm font-medium",htmlFor:"type",children:"Device type"}),a.jsx("input",{id:"type",value:N,onChange:e=>j(e.target.value),className:"w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm",required:!0,disabled:!(0,b.A)(t?.role,["ADMIN","MANAGER","TECHNICIAN"])})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-sm font-medium",htmlFor:"brand",children:"Brand"}),a.jsx("input",{id:"brand",value:y,onChange:e=>A(e.target.value),className:"w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm",disabled:!(0,b.A)(t?.role,["ADMIN","MANAGER","TECHNICIAN"])})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-sm font-medium",htmlFor:"model",children:"Model"}),a.jsx("input",{id:"model",value:f,onChange:e=>C(e.target.value),className:"w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm",disabled:!(0,b.A)(t?.role,["ADMIN","MANAGER","TECHNICIAN"])})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-sm font-medium",htmlFor:"serial",children:"Serial"}),a.jsx("input",{id:"serial",value:w,onChange:e=>D(e.target.value),className:"w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm",disabled:!(0,b.A)(t?.role,["ADMIN","MANAGER","TECHNICIAN"])})]})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-sm font-medium",htmlFor:"notes",children:"Notes"}),a.jsx("input",{id:"notes",value:M,onChange:e=>E(e.target.value),className:"w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm",disabled:!(0,b.A)(t?.role,["ADMIN","MANAGER","TECHNICIAN"])})]}),I?a.jsx("p",{className:"text-sm text-red-500",children:I}):null,(0,b.A)(t?.role,["ADMIN","MANAGER","TECHNICIAN"])?a.jsx(p.z,{type:"submit",disabled:q.isPending,children:q.isPending?"Saving…":"Save changes"}):null]})]}),(0,a.jsxs)("aside",{className:"rounded-xl border bg-card p-4",children:[a.jsx("h3",{className:"mb-2 text-sm font-semibold text-muted-foreground",children:"Related Jobs"}),g?g.jobs&&0!==g.jobs.length?a.jsx("ul",{className:"space-y-2 text-sm",children:g.jobs.map(e=>a.jsx("li",{children:a.jsx(r.default,{href:`/jobs/${e.id}`,className:"underline hover:no-underline",children:e.title})},e.id))}):a.jsx("p",{className:"text-sm text-muted-foreground",children:"No jobs."}):a.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading…"})]})]})]})})}},3398:(e,s,t)=>{"use strict";t.d(s,{Z:()=>d});var a=t(3227),r=t(1043);t(3677);var i=t(8609);function d({children:e,redirectOnFail:s=!0}){let{user:t,loading:d,error:n,status:l}=(0,i.a)();return((0,r.useRouter)(),d)?a.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading session..."}):!t&&s?null:a.jsx(a.Fragment,{children:e})}},5328:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(e,s)=>!!e&&s.includes(e)},7662:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});let a=(0,t(3189).createProxy)(String.raw`C:\Users\Jokeryazid\Documents\My projek\new whatsappbot\app-WhatsAppboot\apps\web\src\app\devices\[id]\page.tsx#default`)}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[193,937,933,420],()=>t(9511));module.exports=a})();