(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7712],{64901:function(e,t,a){Promise.resolve().then(a.bind(a,53291))},53291:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return b}});var n=a(27573),s=a(88146),r=a(81695),l=a(7653),i=a(77930),o=a(31988),d=a(15969),c=a(22628),u=a(45118),m=a(73638),h=a(10957),x=a(50466),p=a(41799),f=a(327);function b(){var e,t,a;let{id:b}=(0,r.useParams)(),g=(0,r.useRouter)(),v=(0,i.NL)(),y=(0,m.p)(),N=(0,h.N)(),{user:j}=(0,p.a)(),E=(0,o.a)({queryKey:["job",b],queryFn:async()=>(0,u.R1)("/api/jobs/".concat(b))}),D=null===(e=E.data)||void 0===e?void 0:e.job,A=(null===(t=E.data)||void 0===t?void 0:t.qr_url)||"",[C,k]=(0,l.useState)("PENDING"),[w,T]=(0,l.useState)("NORMAL"),[P,I]=(0,l.useState)(""),[S,R]=(0,l.useState)(""),[M,O]=(0,l.useState)(null),F=()=>{D&&(k(D.status),T(D.priority),I(D.dueDate?D.dueDate.substring(0,16):""),R(D.diagnosis||""))};(0,l.useMemo)(()=>{F()},[null==D?void 0:D.id]);let[_,G]=(0,l.useState)(!1),H=(0,d.D)({mutationFn:async()=>(0,u.pE)("/api/jobs/".concat(b),{status:C,priority:w,dueDate:P?new Date(P).toISOString():null,diagnosis:S}),onSuccess:async()=>{await v.invalidateQueries({queryKey:["job",b]}),await v.invalidateQueries({queryKey:["jobs"]}),_||y.success("Job updated")},onError:e=>O((null==e?void 0:e.message)||"Failed to update job")}),{data:L,refetch:z}=(0,o.a)({queryKey:["job-history",b],queryFn:async()=>(0,u.R1)("/api/jobs/".concat(b,"/history"))}),[B,J]=(0,l.useState)(null),[U,W]=(0,l.useState)(""),[q,Q]=(0,l.useState)({}),[K,V]=(0,l.useState)({}),[$,Z]=(0,l.useState)({}),Y=e=>{if(!es)return[];let t=new Date(e.createdAt);return es.filter(e=>3e5>=Math.abs(new Date(e.createdAt).getTime()-t.getTime()))},X=(0,d.D)({mutationFn:async e=>(0,u.QW)("/api/jobs/".concat(b,"/history/").concat(e)),onSuccess:async()=>{await z(),y.success("History entry deleted")},onError:e=>y.error((null==e?void 0:e.message)||"Failed to delete history entry")}),ee=(0,d.D)({mutationFn:async e=>{let{historyId:t,notes:a}=e;return(0,u.pE)("/api/jobs/".concat(b,"/history/").concat(t),{notes:a})},onSuccess:async()=>{await z(),J(null),W(""),Q({}),V({}),Z({}),y.success("History entry updated")},onError:e=>y.error((null==e?void 0:e.message)||"Failed to update history entry")}),et=(0,d.D)({mutationFn:async e=>{let{photoId:t,label:a}=e;return(0,u.pE)("/api/jobs/".concat(b,"/photos/").concat(t),{label:a})},onSuccess:async()=>{await er(),y.success("Photo label updated")},onError:e=>y.error((null==e?void 0:e.message)||"Failed to update photo label")}),ea=(0,d.D)({mutationFn:async e=>{let{historyId:t,files:a,label:n}=e,s=new FormData;return a.forEach(e=>s.append("photos",e)),n&&s.append("label",n),(0,u.zi)("/api/jobs/".concat(b,"/photos"),s)},onSuccess:async()=>{await er(),y.success("Photos uploaded")},onError:e=>y.error((null==e?void 0:e.message)||"Failed to upload photos")}),en=(0,d.D)({mutationFn:async()=>(0,u.sg)("/api/jobs/".concat(b,"/qr/renew"),{}),onSuccess:async()=>{await v.invalidateQueries({queryKey:["job",b]}),y.success("QR reissued")}}),{data:es,refetch:er}=(0,o.a)({queryKey:["job-photos",b],queryFn:async()=>(0,u.R1)("/api/jobs/".concat(b,"/photos"))}),[el,ei]=(0,l.useState)(""),[eo,ed]=(0,l.useState)(null),[ec,eu]=(0,l.useState)(null),em=(0,d.D)({mutationFn:async()=>{if(!eo||0===eo.length)throw Error("Select file(s)");let e=new FormData;return eo.forEach(t=>e.append("photos",t)),el&&e.append("label",el),(0,u.zi)("/api/jobs/".concat(b,"/photos"),e)},onSuccess:async e=>{var t,a,n;ei(""),ed(null),(null===(t=document.getElementById("photo-input"))||void 0===t?void 0:t.value)&&(document.getElementById("photo-input").value=""),await er(),_||y.success("Uploaded ".concat(null!==(n=null!==(a=null==e?void 0:e.length)&&void 0!==a?a:null==eo?void 0:eo.length)&&void 0!==n?n:0," photo(s)"))},onError:e=>{let t=(null==e?void 0:e.message)||"Failed to upload";eu(t),y.error(t)}}),eh=(0,d.D)({mutationFn:async e=>(0,u.QW)("/api/jobs/".concat(b,"/photos/").concat(e)),onSuccess:async()=>{await er(),y.success("Photo deleted")}}),ex=(0,d.D)({mutationFn:async()=>(0,u.QW)("/api/jobs/".concat(b)),onSuccess:async()=>{await v.invalidateQueries({queryKey:["jobs"]}),y.success("Job deleted"),g.replace("/jobs")},onError:e=>y.error((null==e?void 0:e.message)||"Failed to delete job")});return(0,n.jsx)(c.Z,{children:(0,n.jsxs)("section",{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-xs uppercase tracking-[0.35em] text-muted-foreground",children:"Job Detail"}),(0,n.jsx)("h1",{className:"text-2xl font-semibold",children:(null==D?void 0:D.title)||"Loading…"}),D?(0,n.jsxs)("p",{className:"text-sm text-muted-foreground",children:[D.customer.name," • ",[D.device.deviceType,D.device.brand,D.device.model].filter(Boolean).join(" ")]}):null]}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)(x.z,{variant:"outline",asChild:!0,children:(0,n.jsx)(s.default,{href:"/jobs",children:"Back"})}),(0,n.jsx)(x.z,{variant:"destructive",onClick:async()=>{await N({title:"Delete job",description:"Are you sure you want to delete this job? This action cannot be undone.",confirmText:"Delete",variant:"destructive"})&&ex.mutate()},disabled:ex.isPending,children:"Delete"})]})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-3",children:[(0,n.jsxs)("div",{className:"md:col-span-2 space-y-4",children:[(0,n.jsxs)("div",{className:"rounded-xl border bg-card p-4",children:[(0,n.jsx)("h2",{className:"mb-3 text-lg font-semibold",children:"QR Progress"}),A?(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)("p",{className:"text-sm text-muted-foreground break-all",children:[(0,n.jsx)("span",{className:"font-medium",children:"URL:"})," ",A]}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)(x.z,{type:"button",onClick:()=>{var e;null===(e=navigator.clipboard)||void 0===e||e.writeText(A)},children:"Copy link"}),(0,n.jsx)(x.z,{asChild:!0,variant:"outline",children:(0,n.jsx)("a",{href:A,target:"_blank",rel:"noreferrer",children:"Open link"})}),(0,f.A)(null==j?void 0:j.role,["ADMIN","MANAGER","TECHNICIAN"])?(0,n.jsx)(x.z,{variant:"secondary",type:"button",onClick:()=>en.mutate(),disabled:en.isPending,children:en.isPending?"Reissuing…":"Reissue QR"}):null]}),(0,n.jsx)("p",{className:"text-xs text-muted-foreground",children:"Share this link with the customer to check their job progress and photos."})]}):(0,n.jsx)("p",{className:"text-sm text-muted-foreground",children:"Loading QR link…"})]}),(0,n.jsxs)("div",{className:"rounded-xl border bg-card p-4",children:[(0,n.jsx)("h2",{className:"mb-4 text-lg font-semibold",children:"Status Kerja & Photos"}),(0,n.jsx)("div",{className:"mb-4 grid grid-cols-2 gap-2 md:grid-cols-4",children:[{value:"PENDING",label:"Diterima",icon:"\uD83D\uDCE5",color:"amber"},{value:"IN_PROGRESS",label:"Sedang Dibaiki",icon:"\uD83D\uDD27",color:"cyan"},{value:"COMPLETED",label:"Siap Ambil",icon:"✅",color:"green"},{value:"REJECTED",label:"Tidak Dapat Dibaiki",icon:"❌",color:"red"}].map(e=>(0,n.jsxs)("button",{type:"button",onClick:()=>(0,f.A)(null==j?void 0:j.role,["ADMIN","MANAGER","TECHNICIAN"])&&k(e.value),disabled:!(0,f.A)(null==j?void 0:j.role,["ADMIN","MANAGER","TECHNICIAN"]),className:"flex flex-col items-center gap-1 rounded-lg border p-3 text-center transition-all ".concat(C===e.value?"amber"===e.color?"border-amber-500 bg-amber-500/20 text-amber-300":"cyan"===e.color?"border-cyan-500 bg-cyan-500/20 text-cyan-300":"green"===e.color?"border-green-500 bg-green-500/20 text-green-300":"border-red-500 bg-red-500/20 text-red-300":"border-slate-700 bg-slate-900/50 text-slate-400 hover:border-slate-600"),children:[(0,n.jsx)("span",{className:"text-xl",children:e.icon}),(0,n.jsx)("span",{className:"text-xs font-medium",children:e.label})]},e.value))}),(0,n.jsxs)("form",{className:"space-y-4",onSubmit:async e=>{e.preventDefault(),O(null),eu(null),G(!0);try{await H.mutateAsync(),eo&&eo.length>0&&await em.mutateAsync(),eo&&eo.length>0?y.success("Status updated dan ".concat(eo.length," photo(s) uploaded!")):y.success("Status updated!")}catch(e){console.error("Form submission error:",e)}finally{G(!1)}},children:[(0,n.jsxs)("div",{className:"rounded-lg border border-slate-700 bg-slate-900/30 p-4",children:[(0,n.jsxs)("div",{className:"mb-3 flex items-center justify-between",children:[(0,n.jsx)("h3",{className:"text-sm font-semibold text-slate-200",children:"\uD83D\uDCF7 Upload Photos"}),(0,n.jsx)("span",{className:"text-xs text-slate-400 italic",children:"(Pilihan - Skip jika tiada photos)"})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-3",children:[(0,n.jsx)("input",{id:"photo-input",type:"file",accept:"image/*",multiple:!0,onChange:e=>{let t=Array.from(e.target.files||[]);if(t.length>6){ed(null),eu("Select up to ".concat(6," files")),e.target.value="";return}if(t.find(e=>!e.type.startsWith("image/")||e.size>5242880)){ed(null),eu("Only images up to 5 MB each are allowed"),e.target.value="";return}eu(null),ed(t)},className:"md:col-span-2 rounded-md border border-input bg-background px-3 py-2 text-sm text-foreground file:mr-4 file:rounded-md file:border-0 file:bg-cyan-600 file:px-4 file:py-2 file:text-sm file:font-semibold file:text-white hover:file:bg-cyan-700",disabled:!(0,f.A)(null==j?void 0:j.role,["ADMIN","MANAGER","TECHNICIAN"])}),(0,n.jsx)("input",{type:"text",placeholder:"Label (optional)",value:el,onChange:e=>ei(e.target.value),className:"rounded-md border border-input bg-background px-3 py-2 text-sm text-foreground",disabled:!(0,f.A)(null==j?void 0:j.role,["ADMIN","MANAGER","TECHNICIAN"])})]}),(0,n.jsxs)("p",{className:"mt-2 text-xs text-muted-foreground",children:["PNG/JPG/WebP up to 5 MB each. Max 6 files. ",(0,n.jsx)("span",{className:"text-slate-500",children:"Boleh skip jika tiada photos untuk upload."})]}),ec?(0,n.jsx)("p",{className:"mt-2 text-sm text-red-500",children:ec}):null,eo&&eo.length>0&&(0,n.jsxs)("div",{className:"mt-3 rounded-md bg-cyan-500/10 border border-cyan-500/30 p-2 text-xs text-cyan-300",children:["\uD83D\uDCCE ",eo.length," file",eo.length>1?"s":""," selected - akan diupload bersama status update"]})]}),("IN_PROGRESS"===C||"QUOTED"===C||"APPROVED"===C)&&(0,n.jsxs)("div",{className:"rounded-lg border border-cyan-500/30 bg-cyan-950/20 p-4",children:[(0,n.jsx)("h3",{className:"mb-3 text-sm font-semibold text-cyan-300",children:"\uD83D\uDD27 Fasa Kerja Semasa"}),(0,n.jsx)("div",{className:"grid grid-cols-2 gap-2 md:grid-cols-5",children:[{id:"troubleshoot",label:"Troubleshoot",icon:"\uD83D\uDD0D"},{id:"repair",label:"Repair",icon:"\uD83D\uDEE0️"},{id:"order",label:"Order Parts",icon:"\uD83D\uDCE6"},{id:"install",label:"Pemasangan",icon:"⚙️"},{id:"testing",label:"Testing/QA",icon:"✔️"}].map(e=>{var t;let a=(null===(t=S.match(/\[PHASE:(\w+)\]/))||void 0===t?void 0:t[1])||"troubleshoot",s=a===e.id,r=["troubleshoot","repair","order","install","testing"],l=r.indexOf(a)>r.indexOf(e.id);return(0,n.jsxs)("button",{type:"button",onClick:()=>{if(!(0,f.A)(null==j?void 0:j.role,["ADMIN","MANAGER","TECHNICIAN"]))return;let t=S.replace(/\[PHASE:\w+\]\s*/g,"");R("[PHASE:".concat(e.id,"] ").concat(t))},disabled:!(0,f.A)(null==j?void 0:j.role,["ADMIN","MANAGER","TECHNICIAN"]),className:"flex flex-col items-center gap-1 rounded-lg border p-2 text-center transition-all ".concat(s?"border-cyan-400 bg-cyan-500/30 text-cyan-200 ring-2 ring-cyan-500/50":l?"border-green-500/50 bg-green-500/20 text-green-400":"border-slate-700 bg-slate-800/50 text-slate-500 hover:border-slate-600"),children:[(0,n.jsx)("span",{className:"text-lg",children:e.icon}),(0,n.jsx)("span",{className:"text-[10px] font-medium",children:e.label})]},e.id)})})]}),"REJECTED"===C&&(0,n.jsxs)("div",{className:"rounded-lg border border-red-500/30 bg-red-950/20 p-4",children:[(0,n.jsx)("h3",{className:"mb-2 text-sm font-semibold text-red-300",children:"❌ Sebab Tidak Dapat Dibaiki"}),(0,n.jsx)("p",{className:"mb-2 text-xs text-red-400",children:"Sila nyatakan sebab kenapa barang ini tidak dapat dibaiki:"}),(0,n.jsx)("div",{className:"flex flex-wrap gap-2 mb-3",children:["Kerosakan teruk","Part tidak ada","Kos repair > nilai barang","Customer tolak quote","Masalah lain"].map(e=>(0,n.jsx)("button",{type:"button",onClick:()=>{if(!(0,f.A)(null==j?void 0:j.role,["ADMIN","MANAGER","TECHNICIAN"]))return;let t=S.replace(/\[REJECT:.*?\]\s*/g,"");R("[REJECT:".concat(e,"] ").concat(t))},className:"rounded-full px-3 py-1 text-xs font-medium transition-all ".concat(S.includes("[REJECT:".concat(e,"]"))?"bg-red-500/30 text-red-200 ring-1 ring-red-500":"bg-slate-800 text-slate-400 hover:bg-slate-700"),children:e},e))})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsx)("label",{className:"text-sm font-medium",htmlFor:"priority",children:"Prioriti"}),(0,n.jsx)("select",{id:"priority",value:w,onChange:e=>T(e.target.value),className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm text-foreground",disabled:!(0,f.A)(null==j?void 0:j.role,["ADMIN","MANAGER","TECHNICIAN"]),children:["LOW","NORMAL","HIGH","URGENT"].map(e=>(0,n.jsx)("option",{value:e,className:"bg-background text-foreground",children:{LOW:"Rendah",NORMAL:"Biasa",HIGH:"Tinggi",URGENT:"Segera"}[e]||e},e))})]}),(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsx)("label",{className:"text-sm font-medium",htmlFor:"due",children:"ETA Siap"}),(0,n.jsx)("input",{id:"due",type:"datetime-local",value:P,onChange:e=>I(e.target.value),className:"w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm",disabled:!(0,f.A)(null==j?void 0:j.role,["ADMIN","MANAGER","TECHNICIAN"])})]})]}),(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsx)("label",{className:"text-sm font-medium",htmlFor:"diagnosis",children:"\uD83D\uDCDD Catatan Technician"}),(0,n.jsx)("textarea",{id:"diagnosis",value:S.replace(/\[PHASE:\w+\]\s*/g,"").replace(/\[REJECT:.*?\]\s*/g,""),onChange:e=>{let t=S.match(/\[PHASE:\w+\]/),a=S.match(/\[REJECT:.*?\]/),n=t?"".concat(t[0]," "):a?"".concat(a[0]," "):"";R("".concat(n).concat(e.target.value))},placeholder:"Masukkan catatan kerja, masalah yang ditemui, parts yang diganti, dll...",className:"h-28 w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm",disabled:!(0,f.A)(null==j?void 0:j.role,["ADMIN","MANAGER","TECHNICIAN"])}),(0,n.jsx)("p",{className:"text-xs text-muted-foreground",children:"Catatan ini akan dipaparkan kepada customer dalam timeline progress."})]}),M?(0,n.jsx)("p",{className:"text-sm text-red-500",children:M}):null,(0,f.A)(null==j?void 0:j.role,["ADMIN","MANAGER","TECHNICIAN"])?(0,n.jsx)("div",{className:"flex gap-2",children:(0,n.jsx)(x.z,{type:"submit",disabled:H.isPending||em.isPending,className:"flex-1",children:H.isPending||em.isPending?"Menyimpan…":eo&&eo.length>0?"\uD83D\uDCBE Simpan Status & Upload Photos":"\uD83D\uDCBE Simpan & Update Timeline"})}):null]}),(0,n.jsxs)("div",{className:"mt-6 border-t border-slate-800 pt-4",children:[(0,n.jsx)("h3",{className:"mb-3 text-sm font-semibold text-slate-200",children:"\uD83D\uDCF8 Photos Terkumpul"}),es?0===es.length?(0,n.jsx)("p",{className:"text-sm text-muted-foreground",children:"Belum ada photos."}):(0,n.jsx)("div",{className:"grid grid-cols-2 gap-3 md:grid-cols-4",children:es.map(e=>(0,n.jsxs)("figure",{className:"space-y-1",children:[(0,n.jsx)("img",{src:e.url,alt:e.label||"Job photo",className:"h-32 w-full rounded-md object-cover border border-slate-700"}),(0,n.jsxs)("figcaption",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[(0,n.jsx)("span",{className:"truncate",children:e.label||"—"}),(0,f.A)(null==j?void 0:j.role,["ADMIN","MANAGER","TECHNICIAN"])?(0,n.jsx)("button",{className:"rounded border border-red-500/30 bg-red-500/10 px-2 py-0.5 text-red-400 hover:bg-red-500/20 transition-colors",onClick:async()=>{await N({title:"Delete photo",description:"Are you sure you want to delete this photo?",confirmText:"Delete",variant:"destructive"})&&eh.mutate(e.id)},disabled:eh.isPending,children:"\uD83D\uDDD1️"}):null]})]},e.id))}):(0,n.jsx)("p",{className:"text-sm text-muted-foreground",children:"Loading…"})]})]})]}),(0,n.jsxs)("aside",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"rounded-xl border bg-card p-4",children:[(0,n.jsx)("h3",{className:"mb-2 text-sm font-semibold text-muted-foreground",children:"Maklumat Job"}),(0,n.jsxs)("ul",{className:"space-y-2 text-sm",children:[(0,n.jsxs)("li",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-muted-foreground",children:"Job ID:"}),(0,n.jsx)("span",{className:"font-mono text-xs",children:(null==D?void 0:null===(a=D.id)||void 0===a?void 0:a.slice(0,8))||"-"})]}),(0,n.jsxs)("li",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-muted-foreground",children:"Tarikh Masuk:"}),(0,n.jsx)("span",{children:D?new Date(D.createdAt).toLocaleDateString("ms-MY"):"-"})]}),(0,n.jsxs)("li",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-muted-foreground",children:"Status:"}),(0,n.jsx)("span",{className:"font-medium ".concat((null==D?void 0:D.status)==="COMPLETED"?"text-green-400":(null==D?void 0:D.status)==="IN_PROGRESS"?"text-cyan-400":(null==D?void 0:D.status)==="REJECTED"?"text-red-400":(null==D?void 0:D.status)==="APPROVED"?"text-emerald-400":"text-amber-400"),children:{PENDING:"Checked-In",QUOTED:"Diagnosing",APPROVED:"Approved",REJECTED:"Declined",IN_PROGRESS:"In Repair",COMPLETED:"Closed"}[(null==D?void 0:D.status)||""]||(null==D?void 0:D.status)||"-"})]}),(0,n.jsxs)("li",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-muted-foreground",children:"Prioriti:"}),(0,n.jsx)("span",{className:"font-medium ".concat((null==D?void 0:D.priority)==="URGENT"?"text-red-400":(null==D?void 0:D.priority)==="HIGH"?"text-orange-400":(null==D?void 0:D.priority)==="NORMAL"?"text-slate-300":"text-slate-500"),children:{LOW:"Rendah",NORMAL:"Biasa",HIGH:"Tinggi",URGENT:"Segera"}[(null==D?void 0:D.priority)||""]||(null==D?void 0:D.priority)||"-"})]}),(null==D?void 0:D.quotedAmount)&&(0,n.jsxs)("li",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-muted-foreground",children:"Quote:"}),(0,n.jsxs)("span",{className:"font-medium text-emerald-400",children:["RM ",Number(D.quotedAmount).toFixed(2)]})]})]})]}),(0,n.jsxs)("div",{className:"rounded-xl border bg-card p-4",children:[(0,n.jsx)("h3",{className:"mb-2 text-sm font-semibold text-muted-foreground",children:"Timeline Status"}),L?0===L.length?(0,n.jsx)("p",{className:"text-sm text-muted-foreground",children:"Belum ada perubahan."}):(0,n.jsx)("ul",{className:"space-y-3 text-sm max-h-96 overflow-y-auto",children:L.map(e=>{var t;let a=B===e.id,s=(e.notes||"").replace(/\[PHASE:\w+\]\s*/g,"").replace(/\[REJECT:.*?\]\s*/g,"").trim(),r=Y(e),l=K[e.id]||[];return(0,n.jsx)("li",{className:"border-b border-slate-800 pb-3 last:border-b-0",children:(0,n.jsx)("div",{className:"flex items-start justify-between gap-2",children:(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between gap-2 mb-1",children:[(0,n.jsx)("span",{className:"font-medium text-cyan-300",children:{PENDING:"Checked-In",QUOTED:"Diagnosing",APPROVED:"Approved",REJECTED:"Declined",IN_PROGRESS:"In Repair",COMPLETED:"Closed"}[e.status]||e.status}),(0,n.jsx)("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:new Date(e.createdAt).toLocaleString("ms-MY",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})})]}),a?(0,n.jsxs)("div",{className:"mt-2 space-y-3",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"text-xs font-medium mb-1 block",children:"Catatan:"}),(0,n.jsx)("textarea",{value:U,onChange:e=>W(e.target.value),placeholder:"Masukkan catatan...",className:"w-full rounded-md border border-input bg-background px-3 py-2 text-xs text-foreground min-h-[60px]",autoFocus:!0})]}),r.length>0&&(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"text-xs font-medium mb-2 block",children:"\uD83D\uDCF7 Edit Photos:"}),(0,n.jsx)("div",{className:"space-y-2",children:r.map(e=>{var t,a;return(0,n.jsxs)("div",{className:"flex gap-2 items-start p-2 bg-slate-900/50 rounded",children:[(0,n.jsx)("img",{src:e.url,alt:e.label||"Photo",className:"w-16 h-16 object-cover rounded"}),(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)("input",{type:"text",value:null!==(a=null!==(t=q[e.id])&&void 0!==t?t:e.label)&&void 0!==a?a:"",onChange:t=>Q({...q,[e.id]:t.target.value}),placeholder:"Label photo...",className:"w-full rounded-md border border-input bg-background px-2 py-1 text-xs text-foreground mb-1"}),(0,n.jsxs)("div",{className:"flex gap-1",children:[(0,n.jsx)(x.z,{size:"sm",variant:"ghost",className:"h-5 text-xs text-cyan-400",onClick:()=>{var t,a;et.mutate({photoId:e.id,label:null!==(a=null!==(t=q[e.id])&&void 0!==t?t:e.label)&&void 0!==a?a:""})},disabled:et.isPending,children:"Simpan Label"}),(0,n.jsx)(x.z,{size:"sm",variant:"ghost",className:"h-5 text-xs text-red-400",onClick:async()=>{await N({title:"Delete Photo",description:"Are you sure you want to delete this photo?",confirmText:"Delete",variant:"destructive"})&&eh.mutate(e.id)},disabled:eh.isPending,children:"\uD83D\uDDD1️"})]})]})]},e.id)})})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"text-xs font-medium mb-2 block",children:"\uD83D\uDCF7 Tambah Photos Baru:"}),(0,n.jsx)("input",{type:"file",accept:"image/*",multiple:!0,onChange:t=>{let a=Array.from(t.target.files||[]);V({...K,[e.id]:a})},className:"w-full rounded-md border border-input bg-background px-3 py-2 text-xs text-foreground file:mr-4 file:rounded-md file:border-0 file:bg-cyan-600 file:px-4 file:py-2 file:text-sm file:font-semibold file:text-white"}),l.length>0&&(0,n.jsxs)("div",{className:"mt-2",children:[(0,n.jsx)("input",{type:"text",value:null!==(t=$[e.id])&&void 0!==t?t:"",onChange:t=>Z({...$,[e.id]:t.target.value}),placeholder:"Label untuk photos baru (optional)",className:"w-full rounded-md border border-input bg-background px-3 py-2 text-xs text-foreground mb-2"}),(0,n.jsxs)(x.z,{size:"sm",variant:"outline",className:"h-7 text-xs",onClick:()=>{ea.mutate({historyId:e.id,files:l,label:$[e.id]})},disabled:ea.isPending,children:["Upload ",l.length," Photo(s)"]})]})]}),(0,n.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,n.jsx)(x.z,{size:"sm",variant:"default",className:"h-7 text-xs flex-1",onClick:()=>{ee.mutate({historyId:e.id,notes:U})},disabled:ee.isPending||ea.isPending,children:"Simpan Semua"}),(0,n.jsx)(x.z,{size:"sm",variant:"outline",className:"h-7 text-xs",onClick:()=>{J(null),W(""),Q({}),V({}),Z({})},disabled:ee.isPending||ea.isPending,children:"Batal"})]})]}):(0,n.jsxs)(n.Fragment,{children:[s?(0,n.jsx)("p",{className:"text-xs text-muted-foreground mt-1 bg-slate-900/50 rounded px-2 py-1.5",children:s}):null,r.length>0&&(0,n.jsxs)("div",{className:"mt-2 space-y-2",children:[(0,n.jsxs)("div",{className:"text-xs font-medium text-slate-400 mb-1",children:["\uD83D\uDCF7 Photos (",r.length,"):"]}),(0,n.jsx)("div",{className:"grid grid-cols-3 gap-2",children:r.map(e=>(0,n.jsxs)("div",{className:"relative group",children:[(0,n.jsx)("img",{src:e.url,alt:e.label||"Photo",className:"w-full h-20 object-cover rounded border border-slate-700"}),e.label&&(0,n.jsx)("div",{className:"absolute bottom-0 left-0 right-0 bg-black/70 text-white text-[10px] px-1 py-0.5 rounded-b truncate",children:e.label})]},e.id))})]}),(0,f.A)(null==j?void 0:j.role,["ADMIN","MANAGER","TECHNICIAN"])&&(0,n.jsxs)("div",{className:"flex gap-2 mt-2",children:[(0,n.jsx)(x.z,{size:"sm",variant:"ghost",className:"h-6 text-xs text-cyan-400 hover:text-cyan-300",onClick:()=>{J(e.id),W(s);let t={};r.forEach(e=>{t[e.id]=e.label||""}),Q(t)},children:"✏️ Edit"}),(0,n.jsx)(x.z,{size:"sm",variant:"ghost",className:"h-6 text-xs text-red-400 hover:text-red-300",onClick:async()=>{await N({title:"Delete History Entry",description:"Are you sure you want to delete this timeline entry? This action cannot be undone.",confirmText:"Delete",variant:"destructive"})&&X.mutate(e.id)},disabled:X.isPending,children:"\uD83D\uDDD1️ Delete"})]})]})]})})},e.id)})}):(0,n.jsx)("p",{className:"text-sm text-muted-foreground",children:"Memuatkan…"})]})]})]})]})})}},22628:function(e,t,a){"use strict";a.d(t,{Z:function(){return i}});var n=a(27573),s=a(81695),r=a(7653),l=a(41799);function i(e){let{children:t,redirectOnFail:a=!0}=e,{user:i,loading:o,error:d,status:c}=(0,l.a)(),u=(0,s.useRouter)();return((0,r.useEffect)(()=>{if(a&&!o&&(!i||d||"unauthenticated"===c)){let e=d?"?reason=".concat(encodeURIComponent(d)):"";u.replace("/login".concat(e))}},[i,o,d,u,a,c]),o)?(0,n.jsx)("p",{className:"text-sm text-muted-foreground",children:"Loading session..."}):!i&&a?null:(0,n.jsx)(n.Fragment,{children:t})}},10957:function(e,t,a){"use strict";a.d(t,{N:function(){return o},W:function(){return i}});var n=a(27573),s=a(7653),r=a(3458);let l=(0,s.createContext)(void 0);function i(e){let{children:t}=e,[a,i]=(0,s.useState)(null),[o,d]=(0,s.useState)(!1),c=(0,s.useRef)(null),u=(0,s.useRef)(null),m=(0,s.useRef)(null);(0,s.useEffect)(()=>{d(!0)},[]);let h=(0,s.useCallback)(e=>new Promise(t=>{var a,n,s,r,l;i({id:Date.now(),resolve:t,title:null!==(a=e.title)&&void 0!==a?a:"Confirm action",description:null!==(n=e.description)&&void 0!==n?n:"Are you sure you want to proceed? This action cannot be undone.",confirmText:null!==(s=e.confirmText)&&void 0!==s?s:"Confirm",cancelText:null!==(r=e.cancelText)&&void 0!==r?r:"Cancel",variant:null!==(l=e.variant)&&void 0!==l?l:"default"})}),[]),x=(0,s.useMemo)(()=>({confirm:h}),[h]),p=(0,s.useCallback)(e=>{i(t=>(t&&t.resolve(e),null))},[]);(0,s.useEffect)(()=>{if(!a)return;c.current=document.activeElement||null;let e=setTimeout(()=>{var e;null===(e=u.current||m.current)||void 0===e||e.focus()},0),t=e=>{if(a){if("Escape"===e.key){e.preventDefault(),p(!1);return}if("Enter"===e.key){e.preventDefault(),p(!0);return}if("Tab"===e.key){let t=[m.current,u.current].filter(Boolean);if(0===t.length)return;let a=t.indexOf(document.activeElement);if(e.shiftKey){let n=a<=0?t[t.length-1]:t[a-1];e.preventDefault(),n.focus()}else{let n=-1===a||a>=t.length-1?t[0]:t[a+1];e.preventDefault(),n.focus()}}}};return document.addEventListener("keydown",t),()=>{clearTimeout(e),document.removeEventListener("keydown",t);try{var a;null===(a=c.current)||void 0===a||a.focus()}catch(e){}}},[a,p]);let f=o&&a?(0,n.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",role:"presentation",children:[(0,n.jsx)("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:()=>p(!1)}),(0,n.jsxs)("div",{className:"relative z-10 w-full max-w-sm rounded-xl border border-slate-800 bg-slate-950/90 p-5 shadow-2xl shadow-black/40 outline-none backdrop-blur",role:"dialog","aria-modal":"true","aria-labelledby":"confirm-title","aria-describedby":"confirm-desc",tabIndex:-1,children:[(0,n.jsx)("h3",{id:"confirm-title",className:"mb-1 text-lg font-semibold text-slate-50",children:a.title}),(0,n.jsx)("p",{id:"confirm-desc",className:"mb-4 text-sm text-slate-300",children:a.description}),(0,n.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,n.jsx)("button",{ref:m,className:"rounded-md border border-slate-700 px-3 py-1.5 text-sm text-slate-200 transition hover:border-slate-500 hover:bg-slate-900",onClick:()=>p(!1),children:a.cancelText}),(0,n.jsx)("button",{ref:u,className:"rounded-md px-3 py-1.5 text-sm text-white transition ".concat("destructive"===a.variant?"bg-red-600 hover:bg-red-700":"bg-sky-600 hover:bg-sky-500"),onClick:()=>p(!0),children:a.confirmText})]})]})]}):null;return(0,n.jsxs)(l.Provider,{value:x,children:[t,o&&"undefined"!=typeof document&&f?(0,r.createPortal)(f,document.body):null]})}function o(){let e=(0,s.useContext)(l);if(!e)throw Error("useConfirm must be used within ConfirmProvider");return e.confirm}},73638:function(e,t,a){"use strict";a.d(t,{V:function(){return o},p:function(){return d}});var n=a(27573),s=a(7653),r=a(3458);function l(e){let{message:t,variant:a="info",onClose:r,duration:l=2500}=e;return(0,s.useEffect)(()=>{if(!l)return;let e=setTimeout(()=>r&&r(),l);return()=>clearTimeout(e)},[l,r]),(0,n.jsx)("div",{className:"pointer-events-auto fixed bottom-4 right-4 z-50 max-w-sm rounded-lg border bg-slate-950/90 px-4 py-3 shadow-lg shadow-black/40 backdrop-blur ".concat("success"===a?"border-emerald-500/60 text-emerald-50":"error"===a?"border-red-500/60 text-red-50":"warning"===a?"border-amber-500/60 text-amber-50":"border-slate-700 text-slate-50"),role:"status","aria-live":"polite",children:(0,n.jsxs)("div",{className:"flex items-start gap-3",children:[(0,n.jsx)("div",{className:"text-sm",children:t}),r?(0,n.jsx)("button",{className:"ml-auto text-xs text-slate-300 opacity-80 transition hover:opacity-100",onClick:r,"aria-label":"Close",children:"x"}):null]})})}let i=(0,s.createContext)(void 0);function o(e){let{children:t}=e,[a,o]=(0,s.useState)([]),[d,c]=(0,s.useState)(!1);(0,s.useEffect)(()=>{c(!0)},[]);let u=(0,s.useCallback)(e=>{o(t=>t.filter(t=>t.id!==e))},[]),m=(0,s.useCallback)((e,t)=>{var a,n;let s={id:Math.floor(Date.now()+1e3*Math.random()),message:e,variant:null!==(a=null==t?void 0:t.variant)&&void 0!==a?a:"info",duration:null!==(n=null==t?void 0:t.duration)&&void 0!==n?n:2500};o(e=>[...e,s])},[]),h=(0,s.useMemo)(()=>({show:m,success:(e,t)=>m(e,{variant:"success",duration:t}),error:(e,t)=>m(e,{variant:"error",duration:t}),info:(e,t)=>m(e,{variant:"info",duration:t}),warning:(e,t)=>m(e,{variant:"warning",duration:t})}),[m]);(0,s.useEffect)(()=>(globalThis.__toast=h,()=>{globalThis.__toast===h&&delete globalThis.__toast}),[h]);let x=d&&a.length>0?(0,n.jsx)(n.Fragment,{children:a.map(e=>(0,n.jsx)(l,{message:e.message,variant:e.variant,duration:e.duration,onClose:()=>u(e.id)},e.id))}):null;return(0,n.jsxs)(i.Provider,{value:h,children:[t,d&&"undefined"!=typeof document&&x?(0,r.createPortal)(x,document.body):null]})}function d(){let e=(0,s.useContext)(i);if(!e)throw Error("useToast must be used within ToastProvider");return e}},50466:function(e,t,a){"use strict";a.d(t,{z:function(){return d}});var n=a(27573),s=a(7653),r=a(8828),l=a(49289),i=a(29147);let o=(0,l.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",outline:"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=s.forwardRef((e,t)=>{let{className:a,variant:s,size:l,asChild:d=!1,...c}=e,u=d?r.g7:"button";return(0,n.jsx)(u,{className:(0,i.cn)(o({variant:s,size:l,className:a})),ref:t,...c})});d.displayName="Button"},45118:function(e,t,a){"use strict";a.d(t,{QW:function(){return h},R1:function(){return u},SC:function(){return d},pE:function(){return m},sg:function(){return c},zi:function(){return x}});let n="http://localhost:4000",s=()=>window.sessionStorage,r="accessToken",l="refreshToken",i=e=>e.startsWith("/api/auth/login")||e.startsWith("/api/auth/register")||e.startsWith("/api/auth/refresh"),o=!1;async function d(e){var t,a,c,u,m,h,x,p,f;let b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{method:g="GET",body:v,headers:y,_retry:N}=b,j="".concat(n).concat(e),E=s(),D=(null==E?void 0:E.getItem(r))||null,A=(null==E?void 0:E.getItem(l))||null;try{let s=await fetch(j,{method:g,headers:{"Content-Type":"application/json",...y||{},...D&&!i?{Authorization:"Bearer ".concat(D)}:{}},body:v?JSON.stringify(v):void 0,credentials:"include"}),o=await s.text(),m={};if(o)try{m=JSON.parse(o)}catch(e){m={message:o}}if(!s.ok){let o=(null==m?void 0:m.message)||"HTTP ".concat(s.status,": ").concat(s.statusText);if(console.error("[API] Request failed: ".concat(g," ").concat(j," - ").concat(o)),401===s.status&&(console.warn("[API] Unauthorized – will let auth layer handle redirect / logout"),!i(e)&&!N&&A)){try{let t=await fetch("".concat(n,"/api/auth/refresh"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:A}),credentials:"include"});if(t.ok){let a=await t.json(),n=null==a?void 0:a.accessToken,s=null==a?void 0:a.refreshToken;return n&&(null==E||E.setItem(r,n)),s&&(null==E||E.setItem(l,s)),d(e,{...b,_retry:!0})}}catch(e){console.error("[API] Refresh token request failed",e)}null==E||E.removeItem(r),null==E||E.removeItem(l)}if(502===s.status||503===s.status||504===s.status){let e={code:"BACKEND_UNAVAILABLE",message:"Backend API server is not running. Please start the API server on port 4000."};try{null===(a=globalThis.__toast)||void 0===a||null===(t=a.error)||void 0===t||t.call(a,e.message)}catch(e){}let n=Error(e.message);throw n.code=e.code,n}try{null===(u=globalThis.__toast)||void 0===u||null===(c=u.error)||void 0===c||c.call(u,o)}catch(e){}throw Error(o)}return m}catch(t){if((null==t?void 0:null===(m=t.message)||void 0===m?void 0:m.includes("Failed to fetch"))||(null==t?void 0:null===(h=t.message)||void 0===h?void 0:h.includes("NetworkError"))||(null==t?void 0:null===(x=t.message)||void 0===x?void 0:x.includes("ECONNREFUSED"))||(null==t?void 0:t.name)==="TypeError"){let e={code:"BACKEND_UNAVAILABLE",message:"Backend API server is not running. Please start the API server on port 4000."};o||(console.error("[API] Connection error: ".concat(g," ").concat(j),t),o=!0);try{null===(f=globalThis.__toast)||void 0===f||null===(p=f.error)||void 0===p||p.call(f,e.message)}catch(e){}let a=Error(e.message);throw a.code=e.code,a}if(t instanceof Error&&t.message)throw t;let e=(null==t?void 0:t.message)||"Failed to fetch: ".concat(g," ").concat(j);throw console.error("[API] Request error: ".concat(g," ").concat(j),t),Error(e)}}let c=(e,t)=>d(e,{method:"POST",body:t}),u=e=>d(e,{method:"GET"}),m=(e,t)=>d(e,{method:"PUT",body:t}),h=e=>d(e,{method:"DELETE"});async function x(e,t){let a=await fetch("".concat(n).concat(e),{method:"POST",body:t,credentials:"include"}),s=await a.text(),r=s?JSON.parse(s):{};if(!a.ok)throw Error((null==r?void 0:r.message)||"HTTP ".concat(a.status));return r}},41799:function(e,t,a){"use strict";a.d(t,{H:function(){return c},a:function(){return u}});var n=a(27573),s=a(7653),r=a(45118);let l=(0,s.createContext)(void 0),i=()=>window.sessionStorage,o="accessToken",d="refreshToken",c=e=>{let{children:t}=e,[a,c]=(0,s.useState)(null),[u,m]=(0,s.useState)("authenticating"),[h,x]=(0,s.useState)(null),[p,f]=(0,s.useState)(null),b="authenticating"===u,g=(0,s.useCallback)(()=>{let e=i();null==e||e.removeItem(o),null==e||e.removeItem(d),f(null)},[]),v=(0,s.useCallback)(()=>{let e=i();return e?{access:e.getItem(o),refresh:e.getItem(d)}:{access:null,refresh:null}},[]),y=(0,s.useCallback)((e,t)=>{let a=i();a&&(e&&a.setItem(o,e),t&&a.setItem(d,t))},[]),N=(0,s.useCallback)(async()=>{let e=await (0,r.R1)("/api/auth/me");return c(e),m("authenticated"),x(null),e},[]),j=(0,s.useCallback)(async()=>{let{refresh:e}=v();if(!e)return!1;try{let a=await (0,r.sg)("/api/auth/refresh",{refreshToken:e});if(null==a?void 0:a.accessToken){var t;return y(a.accessToken,null!==(t=a.refreshToken)&&void 0!==t?t:e),f(a.accessToken),!0}return!1}catch(e){return g(),!1}},[g,v,y]),E=(0,s.useCallback)(async(e,t)=>{x(null),m("authenticating");try{let n=await (0,r.sg)("/api/auth/login",{email:e,password:t});if(null==n?void 0:n.accessToken){var a;y(n.accessToken,null!==(a=n.refreshToken)&&void 0!==a?a:null),f(n.accessToken)}let s=(null==n?void 0:n.user)?n.user:await N();c(s),m("authenticated")}catch(e){throw x((null==e?void 0:e.message)||"Login failed"),m("unauthenticated"),g(),e}},[N,y,g]),D=(0,s.useCallback)(async()=>{try{let{refresh:e}=v();e&&await (0,r.sg)("/api/auth/logout",{refreshToken:e})}catch(e){}finally{g(),c(null),m("unauthenticated")}},[g,v]);(0,s.useEffect)(()=>{let e=!1;return(async()=>{m("authenticating");try{let{access:t,refresh:a}=v(),n=!!t;!n&&a?n=await j():t&&f(t),n?(await N(),e||m("authenticated")):e||(m("unauthenticated"),c(null))}catch(t){if(!e){let e=(null==t?void 0:t.message)||"";(e.includes("Backend API")||e.includes("BACKEND_UNAVAILABLE"))&&x(e),m("unauthenticated"),c(null),g()}}})(),()=>{e=!0}},[j,N,g,v]);let A=(0,s.useMemo)(()=>({user:a,loading:b,status:u,error:h,login:E,logout:D,accessToken:p}),[a,b,u,h,E,D,p]);return(0,n.jsx)(l.Provider,{value:A,children:t})},u=()=>{let e=(0,s.useContext)(l);if(!e)throw Error("useAuth must be used within AuthProvider");return e}},327:function(e,t,a){"use strict";a.d(t,{A:function(){return n}});let n=(e,t)=>!!e&&t.includes(e)},29147:function(e,t,a){"use strict";a.d(t,{cn:function(){return n}});let n=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter(Boolean).join(" ")}},88146:function(e,t,a){"use strict";a.d(t,{default:function(){return s.a}});var n=a(16340),s=a.n(n)},94492:function(e,t,a){"use strict";a.d(t,{F:function(){return r},e:function(){return l}});var n=a(7653);function s(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function r(...e){return t=>{let a=!1,n=e.map(e=>{let n=s(e,t);return a||"function"!=typeof n||(a=!0),n});if(a)return()=>{for(let t=0;t<n.length;t++){let a=n[t];"function"==typeof a?a():s(e[t],null)}}}}function l(...e){return n.useCallback(r(...e),e)}},8828:function(e,t,a){"use strict";a.d(t,{g7:function(){return c}});var n,s=a(7653),r=a(94492),l=a(27573),i=Symbol.for("react.lazy"),o=(n||(n=a.t(s,2)))[" use ".trim().toString()];function d(e){var t;return null!=e&&"object"==typeof e&&"$$typeof"in e&&e.$$typeof===i&&"_payload"in e&&"object"==typeof(t=e._payload)&&null!==t&&"then"in t}var c=function(e){let t=function(e){let t=s.forwardRef((e,t)=>{let{children:a,...n}=e;if(d(a)&&"function"==typeof o&&(a=o(a._payload)),s.isValidElement(a)){var l;let e,i;let o=(l=a,(e=Object.getOwnPropertyDescriptor(l.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning?l.ref:(e=Object.getOwnPropertyDescriptor(l,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning?l.props.ref:l.props.ref||l.ref),d=function(e,t){let a={...t};for(let n in t){let s=e[n],r=t[n];/^on[A-Z]/.test(n)?s&&r?a[n]=(...e)=>{let t=r(...e);return s(...e),t}:s&&(a[n]=s):"style"===n?a[n]={...s,...r}:"className"===n&&(a[n]=[s,r].filter(Boolean).join(" "))}return{...e,...a}}(n,a.props);return a.type!==s.Fragment&&(d.ref=t?(0,r.F)(t,o):o),s.cloneElement(a,d)}return s.Children.count(a)>1?s.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}(e),a=s.forwardRef((e,a)=>{let{children:n,...r}=e;d(n)&&"function"==typeof o&&(n=o(n._payload));let i=s.Children.toArray(n),c=i.find(m);if(c){let e=c.props.children,n=i.map(t=>t!==c?t:s.Children.count(e)>1?s.Children.only(null):s.isValidElement(e)?e.props.children:null);return(0,l.jsx)(t,{...r,ref:a,children:s.isValidElement(e)?s.cloneElement(e,void 0,n):null})}return(0,l.jsx)(t,{...r,ref:a,children:n})});return a.displayName=`${e}.Slot`,a}("Slot"),u=Symbol("radix.slottable");function m(e){return s.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===u}},49289:function(e,t,a){"use strict";a.d(t,{j:function(){return l}});var n=a(10607);let s=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,r=n.W,l=(e,t)=>a=>{var n;if((null==t?void 0:t.variants)==null)return r(e,null==a?void 0:a.class,null==a?void 0:a.className);let{variants:l,defaultVariants:i}=t,o=Object.keys(l).map(e=>{let t=null==a?void 0:a[e],n=null==i?void 0:i[e];if(null===t)return null;let r=s(t)||s(n);return l[e][r]}),d=a&&Object.entries(a).reduce((e,t)=>{let[a,n]=t;return void 0===n||(e[a]=n),e},{});return r(e,o,null==t?void 0:null===(n=t.compoundVariants)||void 0===n?void 0:n.reduce((e,t)=>{let{class:a,className:n,...s}=t;return Object.entries(s).every(e=>{let[t,a]=e;return Array.isArray(a)?a.includes({...i,...d}[t]):({...i,...d})[t]===a})?[...e,a,n]:e},[]),null==a?void 0:a.class,null==a?void 0:a.className)}},10607:function(e,t,a){"use strict";function n(){for(var e,t,a=0,n="",s=arguments.length;a<s;a++)(e=arguments[a])&&(t=function e(t){var a,n,s="";if("string"==typeof t||"number"==typeof t)s+=t;else if("object"==typeof t){if(Array.isArray(t)){var r=t.length;for(a=0;a<r;a++)t[a]&&(n=e(t[a]))&&(s&&(s+=" "),s+=n)}else for(n in t)t[n]&&(s&&(s+=" "),s+=n)}return s}(e))&&(n&&(n+=" "),n+=t);return n}a.d(t,{W:function(){return n}})}},function(e){e.O(0,[6340,3953,4701,1293,1528,1744],function(){return e(e.s=64901)}),_N_E=e.O()}]);